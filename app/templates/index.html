<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volatility3 Web Interface</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>Volatility3 Web GUI</h1>
            <p>Memory Analysis Tool - Upload, Analyze, Download</p>
        </div>

        <div class="content">
            <!-- Tabs -->
            <div class="tabs">
                <div class="tab active" onclick="showTab('upload')">üìÅ File Management</div>
                <div class="tab" onclick="showTab('analyze')">üîç Analysis</div>
                <div class="tab" onclick="showTab('results')">üìä Results</div>
                <div class="tab" onclick="showTab('help')">üìñ Help</div>
            </div>

            <!-- Upload Tab -->
            <div id="upload-tab" class="tab-content">
                <div class="section">
                    <h3>Upload Memory Dump</h3>
                    <div class="upload-area" id="uploadArea">
                        <p class="upload-text">Click here or drag and drop memory dump files</p>
                        <p class="upload-subtext">Supported formats: .dd, .raw, .mem, .dmp, .img, .vmem, .bin</p>
                        <input type="file" id="fileInput" class="hidden" accept=".dd,.raw,.mem,.dmp,.img,.vmem,.bin"
                            onchange="uploadFile()">
                    </div>
                    <div id="uploadStatus"></div>
                </div>

                <div class="section">
                    <h3>üìã Uploaded Files</h3>
                    <button class="btn btn-primary" onclick="refreshFiles()">üîÑ Refresh</button>
                    <div id="fileList" class="file-list"></div>
                </div>
            </div>

            <!-- Analysis Tab -->
            <div id="analyze-tab" class="tab-content hidden">
                <div class="section">
                    <h3>‚öôÔ∏è Analysis Configuration</h3>
                    <label>Select Memory Dump:</label>
                    <select id="memorySelect"></select>

                    <label>Operating System:</label>
                    <select id="osSelect" onchange="loadCommands()">
                        <option value="">Select OS...</option>
                        <option value="General">General/Framework</option>
                        <option value="Windows">Windows</option>
                        <option value="Linux">Linux</option>
                        <option value="Mac">Mac</option>
                    </select>

                    <div id="windows-shortcuts" class="special-actions hidden">
                        <h4>üîë Windows Analysis Shortcuts</h4>
                        <p class="custom-command-description">
                            BitLocker recovery helper: runs <code>windows.bitlocker</code> with dislocker and collects
                            FVEK keys.
                        </p>
                        <button class="btn btn-primary" onclick="runWindowsBitlocker()">‚ñ∂Ô∏è BitLocker Recovery
                            (FVEK)</button>
                        <small style="display:block;margin-top:6px;opacity:.8;">Executes:
                            <code>/opt/volatility-env/bin/vol -f [file] -vvv windows.bitlocker --tags FVEc Cngb None --dislocker</code>.
                            Any <code>.fvek</code> keys are saved to /data.</small>
                    </div>
                </div>

                <div class="section">
                    <h3>üõ†Ô∏è Available Commands</h3>

                    <!-- Custom Command Input -->
                    <div class="custom-command-section">
                        <h4>üîß Custom Command</h4>
                        <p class="custom-command-description">
                            Run custom Volatility commands with your own parameters.
                            Command prefix: <code>/opt/volatility-env/bin/vol -f [SELECTED_MEMORY_FILE]</code>
                        </p>
                        <div class="custom-command-input-group">
                            <input type="text" id="customCommandInput"
                                placeholder="e.g., windows.hivelist or linux.pslist --pid 1234"
                                class="custom-command-input">
                            <button id="runCustomCommand" class="btn btn-primary" onclick="runCustomCommand()">
                                ‚ñ∂Ô∏è Run Custom Command
                            </button>
                        </div>
                        <div class="custom-command-example">
                            <small>
                                <strong>Examples:</strong><br>
                                ‚Ä¢ <code>windows.hivelist</code><br>
                                ‚Ä¢ <code>windows.pslist --pid 1234</code><br>
                                ‚Ä¢ <code>linux.bash.Bash</code>
                            </small>
                        </div>
                    </div>

                    <div id="commandGrid" class="command-grid"></div>
                </div>

                <!-- Execution Status and Live Status sections removed -->
            </div>

            <!-- Results Tab -->
            <div id="results-tab" class="tab-content hidden">
                <div class="section">
                    <h3>üìä Analysis Results</h3>
                    <button class="btn btn-primary" onclick="refreshResults()">üîÑ Refresh Results</button>
                    <div id="resultsList"></div>
                </div>
            </div>

            <!-- Help Tab -->
            <div id="help-tab" class="tab-content hidden">
                <div class="section">
                    <h3>Volatility3 Documentation</h3>
                    <p>Access the complete Volatility3 documentation from ReadTheDocs for detailed plugin information
                        and usage examples.</p>
                    <div class="help-controls">
                        <button class="btn btn-primary" onclick="openHelpInNewTab()">üìö Open Documentation</button>
                        <p style="margin-top: 15px; color: #c084fc; font-style: italic;">

                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer" id="dynamicFooter">
            <!-- Footer content will be generated by JavaScript -->
        </footer>
    </div>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
    <script>
        // Dynamic Footer Generation
        function createFooter() {
            const footer = document.getElementById('dynamicFooter');
            const currentYear = new Date().getFullYear();

            footer.innerHTML = `
                <div class="footer-content">
                    <div class="footer-links">
                        <a href="https://github.com/volatilityfoundation/volatility3" target="_blank" rel="noopener" class="footer-link">
                            <span class="footer-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2C6.477 2 2 6.484 2 12.021c0 4.428 2.865 8.184 6.839 9.504.5.092.682-.217.682-.483 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.342-3.369-1.342-.454-1.155-1.11-1.463-1.11-1.463-.908-.62.069-.608.069-.608 1.004.07 1.532 1.032 1.532 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.339-2.221-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.025A9.564 9.564 0 0 1 12 6.844c.85.004 1.705.115 2.504.337 1.909-1.295 2.748-1.025 2.748-1.025.546 1.378.202 2.397.1 2.65.64.7 1.028 1.595 1.028 2.688 0 3.847-2.337 4.695-4.566 4.944.359.309.678.919.678 1.852 0 1.336-.012 2.417-.012 2.747 0 .268.18.579.688.481C19.138 20.2 22 16.447 22 12.021 22 6.484 17.523 2 12 2z"/></svg>
                            </span>
                            <span>Volatility3</span>
                        </a>
                        <span class="footer-separator">‚Ä¢</span>
                        <a href="https://github.com/Jonesckevin/Volatility3-WebGui-Docker" target="_blank" rel="noopener" class="footer-link">
                            <span class="footer-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2C6.477 2 2 6.484 2 12.021c0 4.428 2.865 8.184 6.839 9.504.5.092.682-.217.682-.483 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.342-3.369-1.342-.454-1.155-1.11-1.463-1.11-1.463-.908-.62.069-.608.069-.608 1.004.07 1.532 1.032 1.532 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.339-2.221-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.025A9.564 9.564 0 0 1 12 6.844c.85.004 1.705.115 2.504.337 1.909-1.295 2.748-1.025 2.748-1.025.546 1.378.202 2.397.1 2.65.64.7 1.028 1.595 1.028 2.688 0 3.847-2.337 4.695-4.566 4.944.359.309.678.919.678 1.852 0 1.336-.012 2.417-.012 2.747 0 .268.18.579.688.481C19.138 20.2 22 16.447 22 12.021 22 6.484 17.523 2 12 2z"/></svg>
                            </span>
                            <span>JonesCKevin</span>
                        </a>
                        <span class="footer-separator"></span>
                    </div>
                </div>
            `;
        }

        // Initialize footer when page loads
        document.addEventListener('DOMContentLoaded', createFooter);
    </script>
</body>

</html>